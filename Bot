from pyrogram import Client, filters
import yt_dlp
import os

API_ID = gRe_-qfHfb8
API_HASH = "gRe_-qfHfb8"
BOT_TOKEN = "8111372305:AAFZ62Tvh1cCsjTrTNbRPqPjFGStdKXNMv0"  # from @BotFather

app = Client("@YtvideodownloaderindiaBOT", gRe_-qfHfb8,gRe_-qfHfb8, 8111372305:AAFZ62Tvh1cCsjTrTNbRPqPjFGStdKXNMv0)

@app.on_message(filters.private & filters.command("start"))
async def start(client, message):
    await message.reply("ðŸ‘‹ Send me a YouTube video link, and I'll download it for you!")

@app.on_message(filters.private & filters.text & ~filters.command("start"))
async def download_video(client, message):
    url = message.text.strip()
    await message.reply("ðŸ“¥ Downloading video... Please wait...")

    try:
        ydl_opts = {
            'outtmpl': '%(title)s.%(ext)s',
            'format': 'bestvideo[filesize<2000000000]+bestaudio/best',
            'merge_output_format': 'mp4',
        }

        with yt_dlp.YoutubeDL(ydl_opts) as ydl:
            info = ydl.extract_info(url, download=True)
            filename = ydl.prepare_filename(info).replace(".webm", ".mp4").replace(".mkv", ".mp4")

        await message.reply_video(video=filename, caption=f"âœ… Downloaded: {info['title']}")
        os.remove(filename)

    except Exception as e:
        await message.reply(f"âŒ Error:\n{str(e)}")

app.run()
